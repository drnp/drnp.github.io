# Resume - 张浩

研发 / 运维 / 架构

```md
* Mobile：18611118254 / 18910299173
* Email ：conan.np@gmail.com
* Wechat：npngny
```

----

## Summary

```md
* 男，1982，辽宁沈阳
* 东北大学（2000-2004）计算机科学与技术 CET-4
* 1998 NOI省赛一等奖
* 2003 软考 高级程序员（信息产业部）
```

```md
* IT / 互联网 / 游戏
* 架构设计 / 后端开发 / 研发效能 / DevOps
* Linux C（自2005） / PHP（自2004） / Go（自2016） / Lua（自2008），其它非主要工作语言
* Linux / 容器 / 云原生 / 微服务
* 网络通讯 / 代码质量度量 / WebGL
* 一线上市公司 / 创业项目
* 20年工作经验
```

```md
* 将近10年游戏行业经历，参与棋牌、策略、休闲类游戏研发及规划，涉及web和移动端。
* 基于大模型、WebGL的数字人产品经历。
* 网络安全行业经历。
* 元宇宙（数字人直播）产品研发经历。
* 音视频生产行业经历。
* 存储类中间件研发经历。
* 智能硬件设计及实现经历。
* 参与早期web2.0创业项目，与Facebook基本同期的社交产品经历。
* 多次完整的服务端架构设计，升级，改造经历。
* 完整落地的研发效能平台，大规模研发体系的研发流程规范审核制定，基于gitlab、jenkins、drone、jira、bugzilla、sonarqube等组件实现的流水线和配置管理平台。
* 完整落地的基于Docker swarm，grafana全系产品，drone等组件实现的CI/CD、开发、生产环境。
```

----

## 工作经历

### 黑尾科技（2018/08 - 至今）

个人公司，部分项目有时段重合

#### Wisekin - 基于大模型的陪伴型数字人

[https://wisekin.cn]

“薇斯姬”是一个基于通用大模型实现的二次元陪伴型数字人。提供语音及文字对话，模拟电话聊天，人物特殊展示类动作等。

接入ChatGPT 3.5/4.0，阿里通义千问，接入Azure TTS / STT提供语音服务。

后端基于 **go-fiber** 的单体服务，移动端基于 **flutter** ，3d数字人基于MMD（Miku Miku Dance）制作，在 **ThreeJS** 中以webgl方式渲染呈现，并同步加载全3D场景，可配置的环境参数及光照，人物可拖动。

实现了大模型服务的封装，会话无缝切换，对文本流的逐句切分（分段TTS）等可配置部分。

接入腾讯云的内容过滤服务。

该项目与 杭州良遇智能 合作，目前已上架主流市场。

#### SmartRigger - 工业生产数据平台

针对铁路系统机务段、车辆段的工业生产流程数据平台。配合智能电控工具，对铁路装配车间的生产状态做出实时反馈，当前用于铁路系统。

服务端基于 **Lumen** 框架（PHP），前端提供了对手持设备和大屏（智能电视）的支持。设备适配器当前支持英格索兰系列电动扭矩扳手，诺霸扭矩校验台协议。

该项目与 沈阳博思远 合作，目前已推进多个机务段。

#### 易玄 / 易旨归 - 汉字、姓名、历法计算服务

<<易玄>>提供如下服务：

```md
* Unihan（标准CJK数据库）的接口级封装
* 三才五格理论的姓名评分计算
* 姓名重合度、诗词古籍出处评估（四书五经、唐宋诗词等）
* 历法换算，包括格里历，阴阳合历，平太阳时，真太阳时，天文及航海沥修正。干支计时及四柱
* 支藏、纳音五行，十神计算
```

相关对接产品目前在线。

#### PandaLink / BS.Play

实时通讯服务，应用于游戏、IM、直播弹幕、应用消息推送等实施场景。

PandaLink和BS.Play是两个独立的版本，PandaLink使用go开发，在高度优化的websocket服务上提供私有的二进制数据协议，配合有android和ios客户端，内部使用了syscall epoll实现比协程切换更高的资源使用效率。业务层面提供群发、组发，提供自定义优先级，支持选择性忽略或丢弃消息。

BS.Play使用C开发，支持lua脚本实现业务逻辑。服务实现了抽象的io复用层、静态线程池、微型自旋锁等。暴露TCP或websocket端口。主要用于状态同步的实时游戏。

PandaLink当前服务于商业产品中。

#### 劳勤云网关

基于特定设备封装的API网关。设备适配器支持汉王系列，中控702系列考勤机 / 打卡机的私有协议，并以标准Restful形式暴露给上层应用。

该服务为劳勤云生态下，“好老板”产品的一部分。与 上海劳勤 合作，当前已下线。

----

### 平行未来 / 人为先科技 （2021/01 - 2022/06）

架构师

#### 新熊猫直播

品牌继承于2016-2019同名产品（PandaTV），寄望于原熊猫直播品牌和用户影响力，以 元宇宙 的新思维形态，打造新的以虚拟形象（中之人）直播、互动娱乐为主线的新熊猫直播产品。

团队骨干为原熊猫直播原班人马。

期间完成后端服务架构设计、选型、规划，基于 go-micro v3 的 微服务 架构，服务端开发流程规范，CodeReview等研发向工作。

前期梳理终结于2019年的PandaTV的后端服务架构和数据，并从0开始推进新系统体系的落地，直到公测前状态。

期间对各业务线提供技术支持，并主导用户体系、资产（金融）体系的服务设计和研发。

独立完整实现用于游戏、直播消息（弹幕等）的长连接 通讯服务 的设计、开发与对接融合。

#### 分秒帧

[https://www.mediatrack.cn]

音视频生产SaaS服务，关注生产者的资产管理、审看、协作。

推动分秒帧服务端技术体系升级，框架整理，go-micro v2至v4的升级，微服务规划，层级调整。并完成部分下层服务的实施。

推进基础研效流程的建立和规范化流程落地。

关键技术方案评审、决策，数据可用性升级方案推进。

----

### 奇安信集团（2019/10 - 2021/01）

架构师（总工办）

#### Hiner - 奇安信制品分发管线

Hiner是集团对外的制品统一发布系统，分为内部发布介面及对外的分发（下载）两部分。于可配置的 **工作流** 模式上完成文件的归集、本地上行、存储备份、散列白名单、CDN等。目前支持集团各业务线的制品发布及下载管理，是软件制品交付的官方认可的唯一渠道。

完成系统的整体架构设计、评审，带领团队实现需求分析及功能开发、测试、落地及对使用方（集团几乎所有产线）的支持与技术服务。

系统由 **go** 语言实现，以多子服务的方式部署于 **Docker Swarm** 集群中，完全通过消息队列耦合。系统对内实现了大文件分片上传、校验、安全扫描（接入天擎、锡安平台。VirusTotal由于成本问题未正式接入），制品包完全递归解压并添加至安全软件的扫描白名单（天擎、安全卫士），CDN推送及自动预热（白山云、金山云、阿里云完整适配），分发权限管理、版本树管理等。对外提供制品索引、版本升级助手等。

后期由于自动化分发的流程需求，对集团内其它工程系统提供对接支持，完成Jfrog Artifactory和裸S3的直接存取支持，跨平台的分发前端工具以及第三方权限对接。

Hiner上线后，替换了旧有的发布系统，承接每天几百次的分发流水线申请，单个超过500GB的制品包，以及递归解压后文件数量放大30万倍的特殊制品包的分发。

#### Fusion - 研发效能数字化度量及流水线平台

聚变（fusion）平台是集团 **数字化** 体系中的重要部分，提供研发类数据指标度量及 **Devops** 流水线实现，对 **研发效能管理** 提供直接重要的量化支持。

研发流程始于VCS动作，通过git hook和gitlab webhook触发fusion流水线执行。流水线以可配置的方式，下层基于 **jenkins** ，串联 **SonarQube** 、开源卫士等代码审查工具、安全扫描工具、自动化测试等，并将结果归集至fusion平台中。

Fusion集中了两种维度的数据，一类是代码资产、一类是流水线执行结果。平台以插件形式，对数据进行各种维度的统计分析，并做可视化展现，包括产线的代码质量统计排行、问题修复时长统计评估、扫描报告等。

同时fusion对接了集团高度定制化的 **jira** 流水线，将测试问题与代码本身实现关联。以及集团内部自研的腾云平台，将开发者工时管理与代码工程质量实现关联。

期间对 **SonarQube** 的原始海量数据做了深度的清洗和整理。

实时通知接入蓝信（奇安信集团安全IM）。

CI流水线同时支持gitlab-ci和jenkins job，CD出口支持接入Hiner制品分发。由于集团的大部分产品，研发最终输出的是制品或实体设备，并不强依赖于部署。

工程数据覆盖集团近4000研发人员，2万多个代码库（10000+活跃），超过20万开发分支，百万次提交行为，代码文本行数超百亿，每日静默分析行为平均4000-5000次。

平台服务化实现，服务端使用 **go** 语言、**postgresql** 数据库，部署于 **Swarm** 集群、前端主要vue实现。

为配合整体要求，开发了大量工具程序及脚本，包括签名检索工具、gitlog清洗工具、各类git hook、分布式任务调配等。

Fusion本身支持Prometheus exporter，并在 **grafana** 上绘制了数据大屏。

----

### 奇虎360（2014/12 - 2017/12）

架构师（网游事业部）

#### 轻游戏平台，PC端加速球游戏内容服务，玩家服务

由于360用户本身没有特别的社交属性，也没有娱乐粘性和过往积累的内容吸引力。所以规划了本意在利用PC端（安全产品、浏览器等）入口通过互动小游戏的方式增加游戏用户活跃度，提供给终端用户更多的内容体验并实现游戏平台的导流。实现轻度游戏的积分、排行、匹配等接口层服务。

部分后端接口，使用PHP开发。

#### PVR游戏（ <<酷跑系列>>等，后端Record及积分服务）

PVR 即Person VS Record，是“人与记录影像对战”的游戏互动方式，这种方式通常用在玩家操作没有相互影响的同场景竞技类（如跑酷、简化型赛车）游戏中（PVR这个词由我创建并推进业务）。用以提供在某种游戏场景下更有效率更及时的对战匹配体验。Record服务后端服务由PHP开发。正常的Record不是视频或小波录像，只是玩家操作行为与恒定帧的对应关系。

酷跑系列在2015年春节期间汇聚了相当的流量，并完成了一部分的平台 **用户转化** 。

#### 实时游戏服务端引擎 / 多人俄罗斯方块

为了提供更多的休闲游戏类型支持，完成更好的对抗体验而设计的实时游戏服务。架构继承自之前的个人项目，使用 **C** 开发网络通讯服务，并嵌入由 **Lua** 编写的游戏业务逻辑，完成对游戏实时体验的支持。

开发了AS3的通讯客户端包，使用 **私有的二进制协议** 提供数据承载和校验。游戏项目本身参考自2003年腾讯游戏大厅上线的“火拼俄罗斯”系列，由于客户端的技术限制，并没有完整地设计火拼系列的操作体验，但是安排了更合理的基于战绩的匹配机制。后期由于项目安排及人员变动，游戏 **未正式上线** 。

#### 游戏平台基础设施 / 容器化调研及实施

本次容器化改造尝试了当时流行的各种技术方案，涉及服务治理、编排、集群、**网络** 等，并最终在 **docker swarm** （由于当时kubernetes的版本跳跃及文档完备性的问题，并未最终采纳）方案上进行了实施操作，迁移了部分服务至swarm集群。在调研过程中，开发了用于nginx（非pro）的配置工具“gourd”的两个版本（ **C** 和 **Lua** ），后业务网关改由 **traefik** 代替。调研中实践了大量组件如etcd，flannel，register等。

#### 实时游戏引擎设计开发

设计并实现通用实时游戏服务端引擎 **langer** 和游戏逻辑容器 **slater** ，并实现游戏《Color&Color》的部分逻辑。langer和slater在之前PVP游戏服务的设计基础上完全由 **Go** 语言重新实现，由于没有嵌入式动态脚本，slater并不适合逻辑频繁修改的业务型游戏，但很适合以房间为组织形式的休闲类游戏。Langer包括完整的认证服务、Dispatcher、Gateway和状态存储，并与slater之间保持稳定的网状通讯。

#### 休闲手游《Color&Color》

《Color&Color》是类似“围城”的一款io游戏，在实现服务端同时，第一次尝试使用 **C#** （Mono）开发了适合 **unity** 的langer客户端，以及游戏GUI调试工具（Windows）。在游戏实现中期，制作了游戏的 **BGM** 及音效。

----

### 炫游在线 / 奇游互动（2012/04 - 2014/12）

架构师 / 运维 / IT

#### 微三国

《微三国》游戏从新浪SAE平台向其它的iaas公有云迁移时遇到了SAE非通用服务的限制。在相对有限的时间里开发上线了模拟真实SAE的HTTP队列和计划任务服务 **FakeSAE** ，使得原有游戏业务代码可以几乎0侵入地迁移至其它公有云平台。FakeSaeQueue依赖redis提供队列存储，实现了SAE自身支持的顺序和并发（乱序）队列，使用 **C** 开发，利用 **静态线程池** 实现HTTP消费前置，用 **Lua** 作为配置脚本，并消除了SAE原有的队列长度限制。自上线服务后稳定运行至2018年游戏下线。

《微三国》系列作为网页游戏，获得了盈利运营超过7年的成绩。

#### 三国霸业

《三国霸业》是公司另外策划的一款三国题材的网页游戏，设计风格相比于微三国更为写实，战斗系统包含实时逻辑。继承自之前的个人项目开发的 **通讯服务** 及 **毫秒级定时器** 对游戏战斗逻辑提供基础支持，使用 **C** 开发服务主体，并嵌入 **Lua** 编写的逻辑脚本。游戏于内测后因为业务调整中断。

----

### 无线天利（2010/06 - 2012/04）

架构师（运财网）

实时推送服务的设计及实施，应用于 **运财网** 投顾平台中。服务依然继承自早先的游戏项目，使用 **C** 开发。

业务平台的 **技术选型** ，方案设计，展示层业务使用 **PHP** 实现，数据层基于JAVA（未参与JAVA项目）和Oracle数据库。

期间提供太平洋保险项目实时通讯支持。

----

### 美嘉传媒（2005/12 - 2010/04）

* 两段工作时间有间隔

### 5jia1 - 社交平台

国内较早一批的社交平台，主打校园社团，为早期的web2.0雏形模式，使用 **PHP** 实现后端逻辑。负责实现 **图像存储** ， **论坛** 等社交模块的业务设计及开发，教育网各名校论坛的热贴 **爬虫** 及清洗重现，后期进行一些框架梳理工作。

### 棋牌游戏通用服务端

第一个版本的实时游戏服务，使用 **C** 开发通讯基础部分，嵌入 **Lua** 开发的业务逻辑，基于 **AS3** （非flex）的Flash客户端。 **独立** 完成服务的实现并参与了第一个基于它的棋牌游戏《BlackJack》的业务逻辑开发，并在uspace上线运营。后因法规限制下架。

### 真人围棋

真人围棋的业务实现，这个版本并算不上严格意义的游戏，更趋向于 **仿真** ，严格遵守19线围棋的规则实现双人对奕。在完全不懂围棋的情况下，用 **Lua** 实现了完整的围棋规则，并实现了Flash版客户端的主要部分。项目上线维持了一段时间并保持了一定的用户活跃程度（由于用户群的特殊性，并不适用常规游戏的衡量标准）。

### 迷你围棋游戏《Batoo》

与韩方合作的游戏项目，非标准围棋规则，而是11/13线的短时制游戏。在文档不完整且无源码的情况下，分析整理韩方的游戏服务的二进制数据协议 ，并用 **AS3** 重写了一个客户端，以支持batoo的web版实现。最终flash版可以与客户端版本实现完全同步并混合游戏。Batoo的国服运营至2010年后关闭。

----

### 新浪网（2006/09 - 2007/09）

服务端开发（互动社区）

#### 新浪博客用户行为分析

通过日志跟踪计算的方式统计了当时博客的用户登录状态，浏览时间，登录后行为等细节数值，用于运营支撑。

#### 新浪博客计数器服务

基于 **memcached** 1.1x改造的数据落地实现，使用 **BerkeleyDB** 用于实际存储，依赖memcached的原子操作进行post维度的访问量统计。服务为后期新浪开源的 **memcachedb** 项目的实现雏形。

----

### 上海群智文化（2004/02 - 2005/08）

服务端开发

#### 动漫游戏类社交平台
  
基于“i”系列的论坛、音乐、资源系统（php实现）。基于静态检索及ftp hook的在线漫画系统comictea。

#### ComicV（东方电视台动漫频道）官网

----

## 其它

* Github：[https://github.com/drnp] [https://github.com/herewetech] [https://github.com/go-sicky]
* 较新的文字内容：[https://54np.com]
* 精于音频处理、音乐制作，曾有工作中亲为BGM的经历
